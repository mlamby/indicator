# Ta-Lib function mapping class 
# Function: '<%= @name %>'
# Description: '<%= @desc %>'
# This file has been autogenerated - Do Not Edit.
class Indicator::AutoGen::<%= @camel_name %> < Indicator::Base
<%@arguments.each do |a|%>
  # <%=a[:name]%> <<%=a[:type]%>>
  attr_accessor :<%= a[:name_us] %>
<%end%>

  def initialize(*args)
<% if @arguments.length > 0 %>
    if args.first.is_a? Hash
      h = args.first
<%@arguments.each do |a|%>
      @<%=a[:name_us]%> = h[:<%=a[:name_us]%>] || <%=a[:default]%>
<%end%>
    else
<%@arguments.each do |a|%>
      @<%=a[:name_us]%> = args[<%=a[:index]%>] || <%=a[:default]%> 
<%end%>
    end
<%end%>    
    @func = TaLib::Function.new("<%=@name%>")
  end

  # Is price data required as an input
  def self.price_input?
    <%= @bar_input %>
  end

  # The list of arguments
  def self.arguments
    [ <%= @arguments.collect { |i| ":#{i[:name_us]}" }.join(", ") %> ]
  end

  # The minimum set of inputs required
  def self.inputs
    [ <%= @inputs.collect { |i| ":#{i[:name_us]}" }.join(", ") %> ]
  end

  # The outputs generated by this function
  def self.outputs
    [ <%= @outputs.collect { |i| ":#{i[:name_us]}" }.join(", ") %> ]
  end

<% if @bar_input %>
  def run(*args)
<%else%>
  def run(<%= @inputs.collect { |i| i[:name_us] }.join(", ")%>)
<%end%>
<% if @bar_input %>
    o, h, l, c, v, len = map_ohlcv(self.class.inputs, *args)
    @func.in_price(0, o, h, l, c, v, nil)
<% else %>
    len = map(<%= @inputs[0][:name_us]%>).length
<%inputs.each do |i|%>
    @func.in_real(<%=i[:index]%>, map(<%=i[:name_us]%>))
<%end%>
<%end%>

<%@arguments.each do |a|%>
    @func.<%=a[:setter]%>(<%=a[:index]%>, @<%=a[:name_us]%>)
<%end%>

<%@outputs.each do |o| %>
    <%=o[:name_us]%> = Array.new(len)
    @func.<%=o[:setter]%>(<%=o[:index]%>, <%=o[:name_us]%>)
<%end%>
  
    @func.call(0, len - 1)

<% if @outputs.length > 1 %>
  {<%=@outputs.collect { |o| ":#{o[:name_us]} => #{o[:name_us]}" }.join(",\n    ") %>}
<%else%>
    <%=@outputs[0][:name_us]%>
<%end%>
  end
end
